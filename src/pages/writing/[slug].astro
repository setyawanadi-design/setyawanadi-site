---
import Layout from "../../layouts/Layout.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
    const writingEntries = await getCollection("writing");
    return writingEntries.map((entry) => ({
        params: { slug: entry.slug },
        props: { entry },
    }));
}

const { entry } = Astro.props;
const { Content } = await entry.render();

function formatDate(d: Date) {
    return new Date(d)
        .toLocaleDateString("en-US", { month: "short", day: "numeric" })
        .toUpperCase();
}
---

<Layout title={`F. â€” ${entry.data.title}`}>
    <main class="flex-1 px-4 md:px-40 py-12 flex justify-center">
        <article class="flex flex-col max-w-2xl flex-1 gap-10">
            <header
                class="flex flex-col gap-6 pt-8 pb-8 border-b border-stone-200 dark:border-stone-800"
            >
                <div class="flex items-center gap-3">
                    <span
                        class="font-mono text-xs text-stone-500 dark:text-stone-400 uppercase tracking-widest border border-stone-200 dark:border-stone-700 px-2 py-1"
                    >
                        {entry.data.category || "NOTE"}
                    </span>
                    <span
                        class="font-mono text-xs text-stone-400 dark:text-stone-500 uppercase tracking-widest"
                    >
                        {formatDate(entry.data.date)}
                    </span>
                </div>
                <h1
                    class="text-stone-900 dark:text-white text-4xl md:text-5xl font-bold tracking-tight leading-[1.1]"
                >
                    {entry.data.title}
                </h1>
            </header>

            {
                entry.data.description && (
                    <div class="font-serif italic text-lg md:text-xl leading-relaxed text-stone-600 dark:text-stone-300">
                        <p>{entry.data.description}</p>
                    </div>
                )
            }

            <div
                class="prose prose-slate dark:prose-invert max-w-none font-serif text-stone-800 dark:text-stone-200 leading-8 prose-p:mb-6 prose-headings:font-display prose-headings:text-stone-900 prose-headings:dark:text-white prose-headings:tracking-tight prose-h2:text-2xl prose-h2:font-bold prose-h2:mt-12 prose-h2:mb-6 prose-code:before:content-none prose-code:after:content-none prose-code:bg-stone-100 prose-code:dark:bg-stone-800 prose-code:px-1.5 prose-code:py-0.5 prose-code:text-sm prose-code:font-mono prose-code:border prose-code:border-stone-200 prose-code:dark:border-stone-700 prose-pre:my-8 prose-pre:border prose-pre:border-stone-200 prose-pre:dark:border-stone-800 prose-pre:bg-stone-50 prose-pre:dark:bg-stone-900 prose-pre:p-6 prose-pre:overflow-x-auto prose-pre:rounded-none prose-pre:text-stone-700 prose-pre:dark:text-stone-300 [&_pre_code]:bg-transparent [&_pre_code]:p-0 [&_pre_code]:text-inherit [&_pre_code]:border-none"
            >
                <Content />
            </div>

            <footer
                class="mt-16 pt-12 border-t border-stone-200 dark:border-stone-800"
            >
                <div
                    class="flex flex-col md:flex-row justify-between items-start md:items-center gap-8"
                >
                    <a
                        class="group flex items-center gap-2 text-stone-500 hover:text-stone-900 dark:text-stone-400 dark:hover:text-white transition-colors font-mono text-sm uppercase tracking-wide"
                        href="/"
                    >
                        <span
                            class="material-symbols-outlined text-lg group-hover:-transtone-x-1 transition-transform"
                            >arrow_back</span
                        >
                        Back to Writing
                    </a>
                    <div
                        class="w-full md:w-auto bg-stone-50 dark:bg-stone-900 border border-stone-200 dark:border-stone-800 p-6 max-w-sm"
                    >
                        <h4
                            class="text-stone-900 dark:text-white font-bold text-lg mb-2"
                        >
                            Thoughts?
                        </h4>
                        <p
                            class="text-stone-600 dark:text-stone-400 font-serif text-sm mb-4 leading-relaxed"
                        >
                            I'm always open to discussing digital durability and
                            minimalist design.
                        </p>
                        <a
                            class="inline-flex items-center justify-center w-full bg-primary hover:bg-primary/90 text-white font-bold text-sm px-6 py-3 transition-colors uppercase tracking-wide"
                            href="mailto:hello@example.com"
                        >
                            Get in touch
                        </a>
                    </div>
                </div>
            </footer>
        </article>
    </main>
</Layout>
